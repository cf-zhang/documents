# 第五章 理解和使用分支

## 5.1 什么叫分支

给分支重命名：

> git branch -m master mymaster

有些版本控制系统在创建分支时会将所有的文件复制到新目录中，git不这样做。它只把分支创建后的修改记录在这个分支上。

创建分支的情况：

* 试验性更改：

> 测试新算法，看看是否会更快；为某个特别的模式重构部分代码；

* 增加新功能：

> 为每个新功能的开发创建新分支，完成该功能的开发后，就可以合并回主分支

* bug修复:

> 不管是修复未发布代码中的bug，还是修复已经标记发布代码中的bug，都可以创建新分支来跟踪对该bug的修改。

## 5.2 创建新分支

git branch new

git checkout new

git checkout -b new

git checkout -b new master

第三个参数告诉git不是从当前分支，而是从master分支上创建新分支

## 5.3 合并分支间的修改

分支对组织版本库非常有用，单必须要在分支间共享修改。共享是由分支合并（merge）来实现的

分支合并方法：

* 直接合并：

> 把两条分支上的历史轨迹合并，交汇到一起

* 压合合并：

> 将一条分支上的若干个提交条目压合成一个提交条目，提交到另一个分支的末梢。

* 拣选合并：

> 拣选另一条分支上的某个提交条目的改动带到当前分支上。

### 直接合并

git checkout master

git merge branch_name

这样就将branch_name分支合并到master上了。

### 压合合并

在 已有的分支上创建新的分支，用于新功能开发或bug修复，然后通过一个压合提交将新分支上的修改合并回来

指的是git将一条分支上的所有历史提交压合成一个提交，提交到另一个分支上。

当想开发一些试验性的新功能或修复bug时，这种合并就很有用，因为此时所需要的并不是长期记录和跟踪每个实验性

git merge --squash branch_name

git commit -m "some messages"

### 拣选合并

有时候分支间只需要合并一个提交，而不需要合并一条分支上的全部改动，因为该分支上的全部改动，因为该分支上可能含有尚未完成的新功能，或者包含其他一些尚不能合并的改动

git cherry-pick "commit-No"

要拣选多个提交，需要给git cherry-pick命令传递参数 -n 告诉git在创建提交之前需要连续进行合并操作

然后使用commit命令进行提交，但是不要使用-m参数，git会使用拣选的提交留言作为当前留言


## 5.4 冲突处理

git不能自动合并时，称之为冲突。冲突总是发生在对不同分支上的同一个文件的同一文本块以不同的方式修改，并试图合并的时候

HEAD是指向当前分支末梢的那个提交

对于简单的合并，只需要手工编辑并解决冲突即可。然后保存修改，暂存并提交，就像正常提交一样

git mergetool

## 5.5 删除分支

有些分支没必要长期保存，比如分支中的代码已经打了标签并已经发布；或者试验分支已经成功完成工作或中途废弃等等。

git branch -d branch_name

只有当要删除的分支已经成功合并到当前分支时，删除分支的操作才会成功。

如果确定无需合并，但需要删除该分支，那么使用-D参数，为强制删除分支

git branch -D branch_name

## 5.6 分支重命名

git branch -m old_branch_name new_branch_name

如果new_branch_name 已经存在那么会失败，使用-M可以强制重命名

git branch -M old_branch_name new_branch_name



 

































