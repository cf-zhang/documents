# 第八章 管理本地版本库

## 8.1 使用标签标记里程碑

标签最常用于给项目代码的发布版本做标识，以便以后在须要修正或功能变更时，可以通过标签回到该发布代码上。

git 标签是只读的

git tag 命令与git branch类似

git tag 1.1

git tag contacts/1.1 contacts

git checkout 1.0 : 检出tag，此时不在任何分支上，没法提交，不能跟踪改动。

然后使用git checkout -b from-1.0 则会有一个新的分支来进行跟踪了。

## 8.2 发布分支的处理

 发布分支是指当一个项目的所有功能都已经开发完成，但尚未达到发布的质量标准时创建的分支
 
 发布分支通常以RB_作为前缀并包含版本号，比如1.2版发布分支可以标示为RB_1.2，1.3版本的发布分支应该标示为RB_1.3
 
 发布分支持续时间不长，通常只用于发布代码的最终测试期间。一旦该版本发布，应该使用标签标记项目，然后将可以删除该发布分支了。
 
## 8.3 标签与分支的有效名称

反斜杠/ 不能作为结尾

圆点. 不能作为开头

不可以在分支名称，标签名称中出现特殊字符： 空格，波浪号，脱字符，冒号，问号，星号，方括号等。

任何位置不可以出现双圆点

## 8.4 记录和跟踪多个项目

* 将所有的项目放到同一个版本库中

* 为每个项目建立单独的版本库

### 多个项目共享一个版本库

每个项目作为整个大项目的一部分

### 多项目多版本库
 
 可以让每个项目都有单独的历史记录
 
 各个小项目是单独发布的
 
## 8.5 使用Git子模块跟踪外部版本库

通过git子模块 可以跟踪外部版本库。它允许在某一个版本库中再存储另一个版本库，并且能够保持两个版本库之间的完全独立。

### 添加新子模块

git submodule 查看当前版本库中的子模块

git submodule add git://github.com/cfzhang/repo.git repo  添加子模块

git submodule init repo  还需要被初始化一下

git commit -m "xxx"  之后就可以提交改动了。

### 克隆含子模块的版本库

git clone magic new-magic 此时可以发现子模块的目录，但是目录为空的

git submodule init hocus  须要再次初始化子模块，此时仍然为空的

git submodule update hocus 这个时候更新到全部文件

### 改变子模块的版本

git 子模块不会自动使用引用版本库中的最新提交

git checkout HEAD

git submodule 和 git status会检测出文件的改动

git add hocus 

git commit -m “xxx” 现在要将最新子模块提交到暂存区并提交，表明确实要引用该版本

### 使用子模块时要提防的错误

* git add 确保结尾处没有斜杠\ ： 代表将原版本库中的全部文件添加到当前版本库，而不是更新子模块引用的版本

* git submodule update 会覆盖本地子模块中没有提交的内容。在update之前请检查本地子模块工作目录树

* 子模块与版本库的分支是分开管理的

* 一旦在子模块中提交修改，必须确保这个改动会被送回子模块的远程版本库，不然update时会出现找不到对应版本的错误




 

